---
machine:
  services:
    - docker

dependencies:
  cache_directories:
    - "~/docker"
  override:
    - docker build --rm=false -t $CIRCLE_SHA1 .

test:
  override:
    - docker run $CIRCLE_SHA1 ansible-playbook -i /nginx-ssl-router/tests/inventory -c local /nginx-ssl-router/tests/test.yml --syntax-check
    - docker run $CIRCLE_SHA1 ansible-playbook -i /nginx-ssl-router/tests/inventory -c local /nginx-ssl-router/tests/test.yml
